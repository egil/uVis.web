var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i};define(["require","exports"],function(n,t){(function(n){(function(n){function r(n,r){return u(r)?new i(n,r):new t(n,r)}function u(){return!1}var t,i;n.create=r,t=function(){function n(n,t){this._key=n,this._value=t}return Object.defineProperty(n.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(){this.value!==this.value&&(this._value=this.value,this.notify())},enumerable:!0,configurable:!0}),n.prototype.attach=function(n){this._subscribers.indexOf(n)===-1&&this._subscribers.push(n)},n.prototype.detach=function(n){this._subscribers.indexOf(n)===-1&&(this._subscribers=_.without(this._subscribers,n))},n.prototype.notify=function(){var n=this;_.each(this._subscribers,function(t){return t.onChange(n)})},n}(),n.Property=t,i=function(n){function t(t,i){n.call(this,t),this._isStale=!0,this._calculatorValue=i}return __extends(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this._isStale&&this.calculateValue(),n.prototype.value},enumerable:!0,configurable:!0}),t.prototype.calculateValue=function(){if(this._updating)throw new Error("Property is updating, possible cyclic dependency. Property: "+this.key);this._updating=!0,this.value=this._calculatorValue(),this._updating=!1},t.prototype.onChange=function(){this._isStale=!0},t}(t),n.CalculatedProperty=i})(n.property||(n.property={}));var t=n.property})(t.uvis||(t.uvis={}));var i=t.uvis})