define(["require","exports","uvis/util/promise"],function(n,t,i){var u=i,r=u.uvis.util,f;(function(n){(function(){describe("Promise",function(){describe("Creating a new Promise",function(){it("should return a Promise object with state unfulfilled",function(){var n=new r.Promise;expect(n.state).toBe("unfulfilled")}),it("should return a Promise object with state fulfilled if created with value",function(){var n=new r.Promise(1);expect(n.state).toBe("fulfilled")})}),describe("Subscribing to a Promise",function(){var n,i=1,t;it("should return the promised value when state is fulfilled",function(){runs(function(){n=new r.Promise,n.done(function(n){t=n}),_.delay(function(){n.fulfill(i)},20)}),waitsFor(function(){return n.state==="fulfilled"},"Promise should be fulfilled",100),runs(function(){expect(t).toBe(i)})}),it("should return the promised value when if subscribed after state is fulfilled",function(){n=new r.Promise(i),n.done(function(n){t=n}),expect(t).toBe(i)}),it("should trigger the fail functions when a promise cannot be fulfilled",function(){runs(function(){n=new r.Promise,t=null,n.fail(function(n){t=n}),_.delay(function(){n.failPromise("error-message")},5)}),waitsFor(function(){return n.state==="failed"},"Promise should have failed",100),runs(function(){expect(t).toBe("error-message")})})})})})(n.spec||(n.spec={}));var t=n.spec})(t.uvis||(t.uvis={})),f=t.uvis})